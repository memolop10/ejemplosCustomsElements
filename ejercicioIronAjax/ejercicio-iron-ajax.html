<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="../iron-ajax/iron-ajax.html">
<link rel="import" href="../paper-card/paper-card.html">
<link rel="import" href="../iron-collapse/iron-collapse.html">

<dom-module id="ejercicio-iron-ajax">
  <template>
    <style>
      :host {
        display: block;
      }
      paper-card {
	      width: 70%;
        margin: 10px;
        --paper-card-background-color:#000F;
        color:#FFFF;
        --paper-card-header-image: {
          max-height: 200px;
          width: 100%;
        };
      }
      p,span{
        margin: 10px;
      }
    </style>

<iron-ajax
  id='ajaxRequest'  
  auto
  url="http://demo6292426.mockable.io/persons"
  on-response="handleResponse"
  >
</iron-ajax>

    <h2>Users List</h2>
    
    <template is="dom-repeat" items="{{users}}" as="user">
      
        <paper-card image="[[user.picture]]">
          <div class="nameContent">
            <p on-click="toggle">[[user.name.first]] [[user.name.last]]</p>
          </div>
          <div class="aboutContent">
            <p>[[user.about]]</p>
          </div>
          <div>
            <span>[[darFormatoBalance(user.balance)]]</span>
          </div>
        </paper-card>
      
    </template>
  </template>

  <script>
    class EjercicioIronAjax extends Polymer.Element {
      static get is() { return 'ejercicio-iron-ajax'; }
      static get properties() {
        return {
          users:Array,
        };
      }

      handleResponse(e,iron){
        console.log(e,iron);
        console.log(iron.response);
        this.set('users',iron.response);
      }

      darFormatoBalance(balance){
        let regExp= /[$]+/g;
        return balance.replaceAll(regExp, "");
      }
     
    }

   

    window.customElements.define(EjercicioIronAjax.is, EjercicioIronAjax);
  </script>
</dom-module>
